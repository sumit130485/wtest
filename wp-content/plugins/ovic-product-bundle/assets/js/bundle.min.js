!function(t){"use strict";function e(){var e=!1,c=!0;t(".product-type-simple .ovic_bundle-products .ovic_bundle-product").each(function(){t(this).attr("data-qty")>0&&0===t(this).attr("data-id")&&(e=!0),t(this).attr("data-qty")>0&&(c=!1)}),e||c?(t(".product-type-simple .ovic_bundle-wrap .single_add_to_cart_button").addClass("disabled"),e?t(".product-type-simple .single_add_to_cart_button").addClass("ovic_bundle-selection"):t(".product-type-simple .single_add_to_cart_button").removeClass("ovic_bundle-selection"),c?t(".product-type-simple .ovic_bundle-wrap .single_add_to_cart_button").addClass("ovic_bundle-empty"):t(".product-type-simple .ovic_bundle-wrap .single_add_to_cart_button").removeClass("ovic_bundle-empty")):t(".product-type-simple .ovic_bundle-wrap .single_add_to_cart_button").removeClass("disabled ovic_bundle-selection ovic_bundle-empty"),i()}function i(){var e=0,i=0,c=0,a="",s="";t(".product-type-simple .ovic_bundle-products .ovic_bundle-product").each(function(){t(this).attr("data-price")>0&&(t(this).find(".ovic_bundle-check input").length&&t(this).find(".ovic_bundle-check input").is(":checked")?(c=t(this).attr("data-price")*t(this).attr("data-qty"),i+=c,e+=c-t(this).attr("data-sale")/100*c):(c=t(this).attr("data-price")*t(this).attr("data-qty"),i+=c,e+=c-t(this).attr("data-sale")/100*c))}),i-=e;var r=o(e,ovic_bundle_vars.price_decimals,"",ovic_bundle_vars.price_thousand_separator,ovic_bundle_vars.price_decimal_separator),d=o(i,ovic_bundle_vars.price_decimals,"",ovic_bundle_vars.price_thousand_separator,ovic_bundle_vars.price_decimal_separator);switch(ovic_bundle_vars.price_format){case"%1$s%2$s":a+=ovic_bundle_vars.currency_symbol+""+r,s+=ovic_bundle_vars.currency_symbol+""+d;break;case"%1$s %2$s":a+=ovic_bundle_vars.currency_symbol+" "+r,s+=ovic_bundle_vars.currency_symbol+" "+d;break;case"%2$s%1$s":a+=r+""+ovic_bundle_vars.currency_symbol,s+=d+""+ovic_bundle_vars.currency_symbol;break;case"%2$s %1$s":a+=r+" "+ovic_bundle_vars.currency_symbol,s+=d+" "+ovic_bundle_vars.currency_symbol;break;default:a+=ovic_bundle_vars.currency_symbol+""+r,s+=ovic_bundle_vars.currency_symbol+""+d}t("#ovic_bundle_total").html(ovic_bundle_vars.bundle_price_text+" <span>"+a+"</span>").slideDown(),t("#ovic_bundle_total_save").html(ovic_bundle_vars.bundle_price_save_text+" <span>"+s+"</span>").slideDown(),t(document.body).trigger("ovic_bundle_calc_price",[e,r,a])}function c(){var e=Array();t(".product-type-simple .ovic_bundle-products .ovic_bundle-product").each(function(){0!==t(this).attr("data-id")&&e.push(t(this).attr("data-id")+"/"+t(this).attr("data-qty")+"/"+t(this).attr("data-sale"))}),t("#ovic_bundle_ids").val(e.join(","))}function o(t,e,i,c,o){t=t||0,e=isNaN(e=Math.abs(e))?2:e,i=void 0!==i?i:"$",c=c||",",o=o||".";var a=0>t?"-":"",s=parseInt(t=Math.abs(+t||0).toFixed(e),10)+"",r=(r=s.length)>3?r%3:0;return i+a+(r?s.substr(0,r)+c:"")+s.substr(r).replace(/(\d{3})(?=\d)/g,"$1"+c)+(e?o+Math.abs(t-s).toFixed(e).slice(2):"")}t(".product-type-simple .ovic_bundle-products select").on("change",function(){t(this).closest(".ovic_bundle-product").attr("data-id",0),e()}),t(document).on("found_variation",function(i,o){t("#ovic_bundle_products").length&&(o.image.url&&o.image.srcset&&(t(i.target).closest(".ovic_bundle-product").find(".ovic_bundle-thumb-ori").hide(),t(i.target).closest(".ovic_bundle-product").find(".ovic_bundle-thumb-new").html('<img src="'+o.image.url+'" srcset="'+o.image.srcset+'"/>').show()),o.price_html&&(t(i.target).closest(".ovic_bundle-product").find(".ovic_bundle-price-ori").hide(),t(i.target).closest(".ovic_bundle-product").find(".ovic_bundle-price-new").html(o.price_html).show()),o.is_purchasable&&(o.is_in_stock?(t("#ovic_bundle_wrap").next("p.stock").show(),t(i.target).closest(".ovic_bundle-product").attr("data-id",o.variation_id),t(i.target).closest(".ovic_bundle-product").attr("data-price",o.display_price),e(),c()):t("#ovic_bundle_wrap").next("p.stock").hide(),""!==o.availability_html&&(t(i.target).closest(".variations_form").find("p.stock").remove(),t(i.target).closest(".variations_form").append(o.availability_html))),""!==o.variation_description?t(i.target).closest(".ovic_bundle-product").find(".ovic_bundle-variation-description").html(o.variation_description).show():t(i.target).closest(".ovic_bundle-product").find(".ovic_bundle-variation-description").html("").hide(),"no"==ovic_bundle_vars.change_image&&t(i.target).closest(".variations_form").trigger("reset_image"))}),t(document).on("reset_data",function(e){t("#ovic_bundle_products").length&&(t(e.target).closest(".ovic_bundle-product").find(".ovic_bundle-thumb-new").hide(),t(e.target).closest(".ovic_bundle-product").find(".ovic_bundle-thumb-ori").show(),t(e.target).closest(".ovic_bundle-product").find(".ovic_bundle-price-new").hide(),t(e.target).closest(".ovic_bundle-product").find(".ovic_bundle-price-ori").show(),t(e.target).closest(".variations_form").find("p.stock").remove(),t(e.target).closest(".ovic_bundle-product").find(".ovic_bundle-variation-description").html("").hide())}),t(".product-type-simple .ovic_bundle-products .ovic_bundle-qty input").on("keyup change",function(){var i=parseInt(t(this).val()),o=parseInt(t(this).attr("min")),a=parseInt(t(this).attr("max"));!isNaN(o)&&o>i&&(i=o),!isNaN(a)&&i>a&&(i=a),t(this).val(i),t(this).closest(".ovic_bundle-product").attr("data-qty",i),e(),c()}),t(".product-type-simple").on("click",".single_add_to_cart_button.disabled",function(e){t(this).hasClass("ovic_bundle-selection")?alert(ovic_bundle_vars.alert_selection):t(this).hasClass("ovic_bundle-empty")&&alert(ovic_bundle_vars.alert_empty),e.preventDefault()}),t(".product-type-simple").on("click",".ovic_bundle-check input",function(){var e=t(this),i=e.closest(".ovic_bundle-product"),c=i.find(".ovic_bundle-qty input");e.is(":checked")?(c.val(1).trigger("change"),c.removeAttr("disabled")):(c.val(0).trigger("change"),c.attr({disabled:"disabled"}))}),window.addEventListener("load",function a(){window.removeEventListener("load",a,!1),e()},!1)}(jQuery);